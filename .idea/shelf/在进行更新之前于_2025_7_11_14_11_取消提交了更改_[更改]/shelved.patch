Index: parent/service/target/classes/mapper/OrderMapper.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\" ?>\r\n<!DOCTYPE mapper\r\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\r\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n<mapper namespace=\"com.zhuxi.mapper.OrderMapper\">\r\n\r\n    <insert id=\"insert\" useGeneratedKeys=\"true\" keyColumn=\"id\" keyProperty=\"id\">\r\n        INSERT INTO `order`(order_sn,user_id, product_id, spec_id, address_id,product_quantity, total_amount,status)\r\n        VALUES (\r\n                #{orderSn},\r\n                #{userId},\r\n                #{productId},\r\n                #{specId},\r\n                #{addressId},\r\n                #{productQuantity},\r\n                #{totalAmount},\r\n                #{status}\r\n               )\r\n    </insert>\r\n\r\n\r\n    <insert id=\"insertOrderList\">\r\n        INSERT INTO\r\n        `order`(order_sn,group_id,user_id, product_id, spec_id, address_id,product_quantity, total_amount,status)\r\n        VALUES\r\n            <foreach collection=\"orderAddDTO\" item=\"item\" separator=\",\">\r\n                (\r\n                #{item.orderSn},\r\n                #{item.groupId},\r\n                #{item.userId},\r\n                #{item.productId},\r\n                #{item.specId},\r\n                #{item.addressId},\r\n                #{item.productQuantity},\r\n                #{item.totalAmount},\r\n                #{item.status}\r\n                )\r\n            </foreach>\r\n    </insert>\r\n\r\n    <insert id=\"insertPaymentList\">\r\n        INSERT INTO payment(payment_sn,user_id, order_id, total_amount,status)\r\n        VALUES\r\n            <foreach collection=\"paymentAddDTO\" item=\"item\" separator=\",\">\r\n                (\r\n                #{item.paymentSn},\r\n                #{item.userId},\r\n                #{item.orderId},\r\n                #{item.totalAmount},\r\n                #{item.status}\r\n                )\r\n            </foreach>\r\n    </insert>\r\n\r\n    <insert id=\"insertInventoryLockList\">\r\n        INSERT INTO inventory_lock(product_id,order_id,spec_id,  quantity, status, expire_time)\r\n        VALUES\r\n            <foreach collection=\"inventoryLockAddDTOS\" item=\"item\" separator=\",\">\r\n                (\r\n                #{item.productId},\r\n                #{item.orderId},\r\n                #{item.specId},\r\n                #{item.quantity},\r\n                0,\r\n                DATE_ADD(now(),INTERVAL 30 MINUTE)\r\n                )\r\n            </foreach>\r\n    </insert>\r\n\r\n    <select id=\"getProductRealStockList\" resultType=\"java.lang.Integer\">\r\n        SELECT real_stock.stock FROM real_stock WHERE spec_id IN\r\n        <foreach item=\"item\" collection=\"specIds\" separator=\",\" open=\"(\" close=\")\">\r\n            #{item}\r\n        </foreach>\r\n    </select>\r\n\r\n    <select id=\"getProductSaleStockList\" resultType=\"java.lang.Integer\">\r\n        SELECT spec.stock FROM spec WHERE id IN\r\n        <foreach item=\"item\" collection=\"specIds\" separator=\",\" open=\"(\" close=\")\">\r\n            #{item}\r\n        </foreach>\r\n    </select>\r\n\r\n    <select id=\"getProductPreStockList\" resultType=\"java.lang.Integer\">\r\n        SELECT COALESCE(SUM(l.quantity),0),t.spec_id\r\n        FROM\r\n        (\r\n           <foreach collection=\"specIds\" item=\"specId\" separator=\"UNION ALL\">\r\n               SELECT #{specId} AS spec_id\r\n           </foreach>\r\n        ) t\r\n        LEFT JOIN inventory_lock l\r\n        ON t.spec_id = l.spec_id\r\n        AND l.status = 0\r\n        AND l.expire_time > now()\r\n        GROUP BY  t.spec_id\r\n        ORDER BY FIELD(\r\n             t.spec_id,\r\n             <foreach collection=\"specIds\" item=\"specId\" separator=\",\">\r\n                 #{specId}\r\n             </foreach>\r\n        )\r\n    </select>\r\n\r\n\r\n    <update id=\"cancelOrderList\">\r\n        UPDATE `order`SET status = 4 WHERE id IN\r\n        <foreach item=\"item\" collection=\"orderIds\" separator=\",\" open=\"(\" close=\")\">\r\n            #{item}\r\n        </foreach>\r\n    </update>\r\n\r\n    <update id=\"cancelPaymentList\">\r\n        UPDATE payment SET status = 4 WHERE order_id IN\r\n        <foreach item=\"item\" collection=\"orderIds\" separator=\",\" open=\"(\" close=\")\">\r\n            #{item}\r\n        </foreach>\r\n    </update>\r\n\r\n\r\n    <update id=\"releaseInventoryLockList\">\r\n        UPDATE inventory_lock SET status = 2 WHERE order_id IN \r\n        <foreach collection=\"orderIds\" item=\"orderId\" separator=\",\" open=\"(\" close=\")\">\r\n            #{orderId}\r\n        </foreach>\r\n    </update>\r\n\r\n    <update id=\"reduceProductSaleStockList\">\r\n        UPDATE spec\r\n        SET stock =\r\n        CASE id\r\n        <foreach collection=\"specIds\" item=\"specId\" index=\"index\">\r\n            WHEN #{specId} THEN stock - #{quantity[${index}]}\r\n        </foreach>\r\n        END\r\n        WHERE id IN\r\n        <foreach collection=\"specIds\" item=\"specId\" open=\"(\"  close=\")\"  separator=\",\">\r\n            #{specId}\r\n        </foreach>\r\n\r\n    </update>\r\n\r\n\r\n    <select id=\"getInventoryLockQuantityList\" resultType=\"Integer\">\r\n        SELECT quantity\r\n        FROM inventory_lock\r\n        WHERE order_id IN\r\n        <foreach item=\"orderId\" collection=\"orderIds\" separator=\",\" open=\"(\" close=\")\">\r\n            #{orderId}\r\n        </foreach>\r\n        ORDER BY\r\n        FIELD(order_id,\r\n        <foreach collection=\"orderIds\" item=\"orderId\" separator=\",\" >\r\n            #{orderId}\r\n        </foreach>\r\n        )\r\n    </select>\r\n\r\n    <select id=\"getSpecIdList\" resultType=\"java.lang.Long\">\r\n        SELECT  inventory_lock.spec_id\r\n        FROM inventory_lock\r\n        WHERE order_id IN \r\n        <foreach collection=\"orderIds\" item=\"orderId\" separator=\",\" open=\"(\" close=\")\">\r\n            #{orderId}\r\n        </foreach>\r\n        ORDER BY FIELD(order_id,\r\n        <foreach collection=\"orderIds\" item=\"orderId\" separator=\",\">\r\n            #{orderId}\r\n        </foreach>\r\n         )\r\n\r\n        </select>\r\n\r\n    <update id=\"releaseProductSaleStockList\">\r\n     UPDATE spec\r\n     SET stock =\r\n     CASE id\r\n     <foreach collection=\"specIds\" item=\"specId\" index=\"index\">\r\n         WHEN #{specId} THEN stock + #{quantityList[${index}]}\r\n     </foreach>\r\n    END\r\n     WHERE id IN\r\n    <foreach collection=\"specIds\" item=\"specId\" open=\"(\"  close=\")\"  separator=\",\">\r\n        #{specId}\r\n    </foreach>\r\n    </update>\r\n\r\n\r\n\r\n\r\n</mapper>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/parent/service/target/classes/mapper/OrderMapper.xml b/parent/service/target/classes/mapper/OrderMapper.xml
--- a/parent/service/target/classes/mapper/OrderMapper.xml	(revision f54807fb79c242fcd80cd2621355f9d19a3bcb77)
+++ b/parent/service/target/classes/mapper/OrderMapper.xml	(date 1752211275090)
@@ -171,6 +171,60 @@
 
         </select>
 
+    <select id="getOrderList" resultType="src.main.java.com.zhuxi.pojo.VO.Order.OrderShowVO">
+    <![CDATA[
+    SELECT * FROM
+     (
+        (
+        SELECT
+            o.id,
+            o.group_id,
+            p.name AS product_name,
+            spec.spec AS spec_name,
+            CASE
+                WHEN spec.cover_url IS NULL  THEN p.cover_url
+                ELSE spec.cover_url
+            END
+            AS cover_url,
+            o.total_amount,
+            o.status,
+            o.created_at
+        FROM `order` o
+        JOIN product p ON o.product_id = p.id
+        LEFT JOIN spec ON o.spec_id = spec.id
+        WHERE o.user_id = #{userId}
+          AND  o.status != 7
+          AND o.group_id IS NOT NULL
+          AND o.id < #{lastId}
+        ORDER BY o.created_at DESC
+        LIMIT #{pageSizeHalf}
+        )
+        UNION ALL
+        (SELECT o.id,
+                o.group_id,
+                p.name    AS product_name,
+                spec.spec AS spec_name,
+                p.cover_url,
+                o.total_amount,
+                o.status,
+                o.created_at
+         FROM `order` o
+         JOIN product p ON o.product_id = p.id
+         LEFT JOIN spec ON o.spec_id = spec.id
+         WHERE o.user_id = #{userId}
+           AND  o.status != 7
+           AND o.group_id IS NULL
+           AND o.id < #{lastId}
+         ORDER BY o.created_at DESC
+         LIMIT #{pageSizeHalf}
+         )
+    ) AS t
+        ORDER BY t.created_at DESC
+    LIMIT #{pageSize}
+    ]]>
+        <bind name="pageSizeHalf" value="pageSize / 2"/>
+    </select>
+
     <update id="releaseProductSaleStockList">
      UPDATE spec
      SET stock =
Index: parent/service/target/classes/mapper/ArticleMapper.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\" ?>\r\n<!DOCTYPE mapper\r\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\r\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n\r\n<mapper namespace=\"com.zhuxi.mapper.ArticleMapper\">\r\n    <select id=\"getListArticle\" resultType=\"src.main.java.com.zhuxi.pojo.VO.Article.ArticleVO\">\r\n        SELECT\r\n            id,\r\n            title,\r\n            type,\r\n            cover_oss,\r\n            created_at\r\n        FROM article\r\n        <where>\r\n            status = 2\r\n            <if test=\"type != null\">\r\n                AND type = #{type}\r\n            </if>\r\n        </where>\r\n\r\n    </select>\r\n\r\n    <select id=\"getListArticleDESC\" resultType=\"src.main.java.com.zhuxi.pojo.VO.Article.ArticleVO\">\r\n\r\n        SELECT\r\n            id,\r\n            title,\r\n            type,\r\n            cover_oss,\r\n            created_at\r\n        FROM article\r\n        <where>\r\n     <![CDATA[\r\n         id < #{lastId} AND status = 2\r\n\r\n           <if test=\"type != null\">\r\n           AND type = #{type}\r\n           </if>\r\n        ]]>\r\n         </where>\r\n        ORDER BY id DESC\r\n        LIMIT #{pageSize}\r\n\r\n    </select>\r\n\r\n    <update id=\"updateArticle\" parameterType=\"src.main.java.com.zhuxi.pojo.DTO.article.ArticleInsertOrUpdateDTO\">\r\n        UPDATE article\r\n            <set>\r\n                <if test=\"aIOUDto.title != null\">\r\n                    title = #{aIOUDto.title},\r\n                </if>\r\n                <if test=\"aIOUDto.status != null\">\r\n                    status = #{aIOUDto.status},\r\n                </if>\r\n                <if test=\"aIOUDto.type != null\">\r\n                    type = #{aIOUDto.type},\r\n                </if>\r\n            </set>\r\n            WHERE id = #{id}\r\n    </update>\r\n</mapper>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/parent/service/target/classes/mapper/ArticleMapper.xml b/parent/service/target/classes/mapper/ArticleMapper.xml
--- a/parent/service/target/classes/mapper/ArticleMapper.xml	(revision f54807fb79c242fcd80cd2621355f9d19a3bcb77)
+++ b/parent/service/target/classes/mapper/ArticleMapper.xml	(date 1752213932614)
@@ -22,7 +22,6 @@
     </select>
 
     <select id="getListArticleDESC" resultType="src.main.java.com.zhuxi.pojo.VO.Article.ArticleVO">
-
         SELECT
             id,
             title,
@@ -31,7 +30,7 @@
             created_at
         FROM article
         <where>
-     <![CDATA[
+        <![CDATA[
          id < #{lastId} AND status = 2
 
            <if test="type != null">
@@ -39,9 +38,8 @@
            </if>
         ]]>
          </where>
-        ORDER BY id DESC
+        ORDER BY id,created_at DESC
         LIMIT #{pageSize}
-
     </select>
 
     <update id="updateArticle" parameterType="src.main.java.com.zhuxi.pojo.DTO.article.ArticleInsertOrUpdateDTO">
